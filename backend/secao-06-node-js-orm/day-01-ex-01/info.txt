Video aula Zambelli, turma 25, aula 6.1
ORM - Sequelize
https://app.betrybe.com/learn/course/5e938f69-6e32-43b3-9685-c936530fd326/live-lectures/4dafa2cb-01f4-45a5-bc69-07d567eb32a2/recording/37bc480e-18e3-4d36-b335-52442b1242b4

Instalação sequelize
https://app.betrybe.com/learn/course/5e938f69-6e32-43b3-9685-c936530fd326/module/94d0e996-1827-4fbc-bc24-c99fb592925b/section/0ca77b1d-4770-4646-8368-167d2305e763/day/0da9bd44-abf6-43d6-96b9-9614274e6c36/lesson/ed46dd6e-bbb3-432d-92a4-b272e42437a9


Montar uma api de cursos

01º: Para iniciar o projeto e criar package.json
npm init -y

02º: Para criar package-lock json (estou fazendo assim, mas é a única etapa sem certeza)
npm i express@4.17.1 --save-exact

03º Criar o arquivo .gitignore e inserir os que ficarão de fora quaando aplicação subir
node_modules

04º Criar o arquivo .env e inseir as devidas configurações
DB_USER=root
DB_PASSWORD=password
DB_NAME=orm_trybe
DB_HOST=container_mysql

05º Ver estrutura de acordo com necessidade
Elaborar docker-compose.yml

06º: No terminal, digitar este comando para criar container
docker-compose up -d

07º: No terminal, digitar este comando para entrar no terminal do container
docker exec -it api bash

08º: No terminal do container, instalar as dependências necessárias
npm i sequelize mysql2 dotenv express express-async-errors
(npm install -E sequelize@6.3.4) - sozinho pelo course

09º: No terminal do container, instalar as dependências de desenvolvimeto necessárias
npm i -D sequelize-cli nodemon

10º: Criar arquivo .sequelizerc
Elaborar a estrutura do arquivo para que tudo fique dentro da pasta src

11º: No terminal do container, inserir este comando para que a estrutura de pastas sejam criadas
npx sequelize-cli init

12º: No arquivo config.js, inserir module.exports = e o require('dotenv').config()
require('dotenv').config();
module.exports = {...};

13º: Fazer as seguintes alterações em "development":
"password": null, para "password": process.env.DB_PASSWORD
"username": "root", para "username": process.env.DB_USERNAME
"database": "database_development", para "database": process.env.DB_NAME
"host": "127.0.0.1", para "host": process.env.DB_HOST
OBS: Olhar as configs deste arquivo e repetir para os demais

14º: Entrar no workbench

15º: Rodar no terminal do container o comando para criar do DB e depois atualizar o workbench
npx sequelize-cli db:create

16º: Rodar no terminal do container o comando para criar tabela e campos
npx sequelize-cli model:create --name Course --attributes name:string,description:string,creation_date:date,active:boolean
OBS: Terá sido criada um arquivo model e um migration. O workbench ainda não foi atualizado.

17º: Ajustar arquivo criado na model.

18º: Para subir esse arquivo migration criado (tabela) no DB:
npx sequelize-cli db:migrate
OBS: para desfazer a última migraton: npx sequelize-cli db:migrate:undo 

19º: Para inserir uma coluna em uma tabela já criada (e depois ajustar arquivo migration):
npx sequelize-cli migration:create --name add-column-duration-table-course

20º: Para subir esse novo arquivo migration criado (ajuste na tabela) no DB:
npx sequelize-cli db:migrate

21º: E isso precisa ser informado na model, essa alteração. Vai no arquivo da model e insere este novo campo.

22º: Agora precisamos popular dados no DB. Para criar seed (depois ajustar arquivo):
npx sequelize-cli seed:create --name courses

23º: Após ajustar arquivo, subir a seed:
npx sequelize-cli db:seed:all
OBS: se quiser reverter: npx sequelize-cli db:seed:undo


- Criar tabela students
npx sequelize-cli migration:create --name create-students

- Subir tabela para DB
npx sequelize-cli db:migrate

- Depois, criar model

- Popular dados em students
npx sequelize-cli seed:create --name courses

- Subir as seeders (subir todas as seeders)
npx sequelize-cli db:seed:all
(subir uma seed específica)
npx sequelize-cli db:seed --seed src/seeders/20230330130353-students.js
(ou ainda)
npx sequelize-cli db:seed --seed src/seeders/*-students.js





node src/server.js
npm run dev